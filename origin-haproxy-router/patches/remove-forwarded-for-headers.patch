--- haproxy-config.template     2019-12-30 13:59:59.000000000 +0100
+++ haproxy-config.template.2   2019-12-30 17:21:38.000000000 +0100
@@ -162,6 +162,15 @@
   monitor-uri /_______internal_router_healthz
   {{- end }}

+  # https://serverfault.com/questions/608256/haproxy-hdr-ip-acl-unaffected-by-reqidel
+  # https://thisinterestsme.com/x-forwarded-for-spoofing-haproxy/
+  reqidel ^Forwarded:.*
+  reqidel ^X-Forwarded-For:.*
+  reqidel ^X-Forwarded-Host:.*
+  reqidel ^X-Forwarded-Port:.*
+  reqidel ^X-Forwarded-Proto:.*
+  reqidel ^X-Forwarded-Proto-Version:.*
+
   # Strip off Proxy headers to prevent HTTpoxy (https://httpoxy.org/)
   http-request del-header Proxy

@@ -236,6 +245,15 @@
     {{- if isTrue (env "ROUTER_ENABLE_HTTP2") }} alpn h2,http/1.1{{ end }}
   mode http

+  # https://serverfault.com/questions/608256/haproxy-hdr-ip-acl-unaffected-by-reqidel
+  # https://thisinterestsme.com/x-forwarded-for-spoofing-haproxy/
+  reqidel ^Forwarded:.*
+  reqidel ^X-Forwarded-For:.*
+  reqidel ^X-Forwarded-Host:.*
+  reqidel ^X-Forwarded-Port:.*
+  reqidel ^X-Forwarded-Proto:.*
+  reqidel ^X-Forwarded-Proto-Version:.*
+
   # Strip off Proxy headers to prevent HTTpoxy (https://httpoxy.org/)
   http-request del-header Proxy

@@ -307,6 +325,15 @@
     {{- end }}
   mode http

+  # https://serverfault.com/questions/608256/haproxy-hdr-ip-acl-unaffected-by-reqidel
+  # https://thisinterestsme.com/x-forwarded-for-spoofing-haproxy/
+  reqidel ^Forwarded:.*
+  reqidel ^X-Forwarded-For:.*
+  reqidel ^X-Forwarded-Host:.*
+  reqidel ^X-Forwarded-Port:.*
+  reqidel ^X-Forwarded-Proto:.*
+  reqidel ^X-Forwarded-Proto-Version:.*
+
   # Strip off Proxy headers to prevent HTTpoxy (https://httpoxy.org/)
   http-request del-header Proxy

