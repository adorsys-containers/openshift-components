--- haproxy-config.template	2019-12-30 13:59:59.000000000 +0100
+++ haproxy-config.template.2	2019-12-31 16:13:27.000000000 +0100
@@ -162,6 +162,15 @@
   monitor-uri /_______internal_router_healthz
   {{- end }}
 
+  # https://serverfault.com/questions/608256/haproxy-hdr-ip-acl-unaffected-by-reqidel
+  # https://thisinterestsme.com/x-forwarded-for-spoofing-haproxy/
+  http-request del-header ^Forwarded:.*
+  http-request del-header ^X-Forwarded-For:.*
+  http-request del-header ^X-Forwarded-Host:.*
+  http-request del-header ^X-Forwarded-Port:.*
+  http-request del-header ^X-Forwarded-Proto:.*
+  http-request del-header ^X-Forwarded-Proto-Version:.*
+
   # Strip off Proxy headers to prevent HTTpoxy (https://httpoxy.org/)
   http-request del-header Proxy
 
@@ -236,6 +245,15 @@
     {{- if isTrue (env "ROUTER_ENABLE_HTTP2") }} alpn h2,http/1.1{{ end }}
   mode http
 
+  # https://serverfault.com/questions/608256/haproxy-hdr-ip-acl-unaffected-by-reqidel
+  # https://thisinterestsme.com/x-forwarded-for-spoofing-haproxy/
+  http-request del-header ^Forwarded:.*
+  http-request del-header ^X-Forwarded-For:.*
+  http-request del-header ^X-Forwarded-Host:.*
+  http-request del-header ^X-Forwarded-Port:.*
+  http-request del-header ^X-Forwarded-Proto:.*
+  http-request del-header ^X-Forwarded-Proto-Version:.*
+
   # Strip off Proxy headers to prevent HTTpoxy (https://httpoxy.org/)
   http-request del-header Proxy
 
@@ -307,6 +325,15 @@
     {{- end }}
   mode http
 
+  # https://serverfault.com/questions/608256/haproxy-hdr-ip-acl-unaffected-by-reqidel
+  # https://thisinterestsme.com/x-forwarded-for-spoofing-haproxy/
+  http-request del-header ^Forwarded:.*
+  http-request del-header ^X-Forwarded-For:.*
+  http-request del-header ^X-Forwarded-Host:.*
+  http-request del-header ^X-Forwarded-Port:.*
+  http-request del-header ^X-Forwarded-Proto:.*
+  http-request del-header ^X-Forwarded-Proto-Version:.*
+
   # Strip off Proxy headers to prevent HTTpoxy (https://httpoxy.org/)
   http-request del-header Proxy
 
@@ -431,9 +458,9 @@
   http-request set-header X-Forwarded-Proto-Version h2 if { ssl_fc_alpn -i h2 }
   {{- if matchPattern "(v4)?v6" $router_ip_v4_v6_mode }}
   # See the quoting rules in https://tools.ietf.org/html/rfc7239 for IPv6 addresses (v4 addresses get translated to v6 when in hybrid mode)
-  http-request add-header Forwarded for=\"[%[src]]\";host=%[req.hdr(host)];proto=%[req.hdr(X-Forwarded-Proto)];proto-version=%[req.hdr(X-Forwarded-Proto-Version)]
+  http-request set-header Forwarded for=\"[%[src]]\";host=%[req.hdr(host)];proto=%[req.hdr(X-Forwarded-Proto)];proto-version=%[req.hdr(X-Forwarded-Proto-Version)]
   {{- else }}
-  http-request add-header Forwarded for=%[src];host=%[req.hdr(host)];proto=%[req.hdr(X-Forwarded-Proto)];proto-version=%[req.hdr(X-Forwarded-Proto-Version)]
+  http-request set-header Forwarded for=%[src];host=%[req.hdr(host)];proto=%[req.hdr(X-Forwarded-Proto)];proto-version=%[req.hdr(X-Forwarded-Proto-Version)]
   {{- end }}
 
   {{- if not (isTrue (index $cfg.Annotations "haproxy.router.openshift.io/disable_cookies")) }}
